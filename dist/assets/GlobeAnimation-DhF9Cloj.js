import{j as c,C as B,O as I,r as p,o as v,p as k}from"./react-vendor-CFT3WQjR.js";import{k as T,l as $,m as H}from"./three-vendor-CjSMXDIJ.js";import"./vendor-C6hWT_e8.js";import"./lottie-vendor-C_DPqqyg.js";const G="/models/ModelGlb.glb";v.preload(G);const U=({count:h=8e3,radius:m=3,modelPath:D=G})=>{const w=p.useRef(null),j=p.useRef(null),[x,z]=p.useState([]),[O,R]=p.useState(!1),[A,E]=p.useState(null);p.useEffect(()=>{const t=new T;try{t.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/")}catch{console.warn("Failed to set external DRACO decoder, trying local fallback"),t.setDecoderPath("/draco/")}return $.addHandler(/\.drc$/,t),()=>{t.dispose()}},[]);const b=v(D);p.useEffect(()=>{if(b&&b.scene){console.log("GLB model loaded successfully:",b);const t=[];(l=>{l.traverse(g=>{if(g instanceof H&&g.geometry){const e=g.geometry.attributes.position;if(e)for(let r=0;r<e.count;r++)t.push(e.getX(r),e.getY(r),e.getZ(r))}})})(b.scene),console.log(`Extracted ${t.length/3} vertices from GLB model`),z(t),R(!0),E(null)}else b?(console.warn("GLB model loaded but no scene found:",b),E("Model loaded but no scene found")):console.log("GLB model not yet loaded")},[b]);const{positions:Z,colors:S,originalPositions:F}=p.useMemo(()=>{const t=new Float32Array(h*3),s=new Float32Array(h*3),l=new Float32Array(h*3),g=Math.floor(h*.4),f=h-g;let e=0;if(x.length>0)for(let r=0;r<g;r++){const i=Math.floor(Math.random()*(x.length/3))*3;let a=x[i]||0,n=x[i+1]||0,o=x[i+2]||0;const u=m*1.4/2;a*=u,n*=u,o*=u;const d=Math.PI/1.8,C=a*Math.cos(d)-o*Math.sin(d),M=a*Math.sin(d)+o*Math.cos(d);a=C,o=M;const y=Math.PI/11,L=n*Math.cos(y)-o*Math.sin(y),P=n*Math.sin(y)+o*Math.cos(y);n=L,o=P,a+=(Math.random()-.5)*.01,n+=(Math.random()-.5)*.01,o+=(Math.random()-.5)*.01,t[e*3]=a,t[e*3+1]=n,t[e*3+2]=o,l[e*3]=a,l[e*3+1]=n,l[e*3+2]=o,s[e*3]=0,s[e*3+1]=0,s[e*3+2]=0,e++}else for(let r=0;r<g;r++){let i,a,n,o;do i=(Math.random()-.5)*2,a=(Math.random()-.5)*2,n=(Math.random()-.5)*2,o=Math.sqrt(i*i+a*a+n*n);while(o>1);const u=Math.pow(Math.random(),1),d=o*u;t[e*3]=i*d*m*.3,t[e*3+1]=a*d*m*.3,t[e*3+2]=n*d*m*.3,l[e*3]=t[e*3],l[e*3+1]=t[e*3+1],l[e*3+2]=t[e*3+2],s[e*3]=0,s[e*3+1]=0,s[e*3+2]=0,e++}for(let r=0;r<f;r++){let i,a,n,o;do i=(Math.random()-.5)*2,a=(Math.random()-.5)*2,n=(Math.random()-.5)*2,o=Math.sqrt(i*i+a*a+n*n);while(o>1);const u=Math.pow(Math.random(),1)*.7+.3,d=o*u;t[e*3]=i*d*m,t[e*3+1]=a*d*m,t[e*3+2]=n*d*m,l[e*3]=t[e*3],l[e*3+1]=t[e*3+1],l[e*3+2]=t[e*3+2],s[e*3]=0,s[e*3+1]=0,s[e*3+2]=0,e++}return{positions:t,colors:s,originalPositions:l}},[h,m,x]);return k(({clock:t})=>{if(!w.current||!j.current)return;const s=t.getElapsedTime(),l=w.current.geometry.attributes.position,g=Math.floor(h*1);j.current.scale.setScalar(1),j.current.rotation.y=s*.2;for(let f=0;f<h;f++){const e=F[f*3],r=F[f*3+1],i=F[f*3+2],n=Math.sqrt(e*e+r*r+i*i)/m,o=.6+f*.001,u=f*.1,d=f*.15,C=f*.05;let M=1;f<g?M=.3:M=Math.min(n*1.5,1);const y=Math.sin(s*o*.15+u)*.06*M,L=Math.cos(s*o*.125+d)*.05*M,P=Math.sin(s*o*.175+C)*.07*M,X=Math.cos(s*o*2.2+u)*.03*M,Y=Math.sin(s*o*1.9+d)*.04*M,q=Math.cos(s*o*2.7+C)*.035*M;l.setXYZ(f,e+y+X,r+L+Y,i+P+q)}l.needsUpdate=!0}),A&&console.error("Model error:",A),x.length===0&&!O?c.jsx("group",{ref:j,children:c.jsxs("mesh",{children:[c.jsx("sphereGeometry",{args:[m*.3,32,32]}),c.jsx("meshBasicMaterial",{color:"black",wireframe:!0})]})}):c.jsx("group",{ref:j,children:c.jsxs("points",{ref:w,children:[c.jsxs("bufferGeometry",{children:[c.jsx("bufferAttribute",{attach:"attributes-position",args:[Z,3],count:h,itemSize:3}),c.jsx("bufferAttribute",{attach:"attributes-color",args:[S,3],count:h,itemSize:3})]}),c.jsx("pointsMaterial",{size:.03,sizeAttenuation:!0,vertexColors:!0,transparent:!1})]})})},K=({className:h="w-full h-[90%] md:w-[1000px] md:h-[1000px]",pointCount:m=8e3,globeRadius:D=3,modelPath:w=G})=>c.jsx("div",{className:`${h} bg-white`,children:c.jsxs(B,{camera:{position:[0,0,10],fov:50,near:.1,far:1e3},gl:{antialias:!0,alpha:!1},children:[c.jsx("color",{attach:"background",args:["white"]}),c.jsx("ambientLight",{intensity:1}),c.jsx(U,{count:m,radius:D,modelPath:w}),c.jsx(I,{enablePan:!1,enableZoom:!0,enableRotate:!0,minDistance:5,maxDistance:50,target:[0,0,0],enableDamping:!0,dampingFactor:.05})]})});export{K as default};
